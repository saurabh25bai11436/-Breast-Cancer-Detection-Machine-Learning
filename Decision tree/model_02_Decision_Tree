# Import necessary libraries
import pandas as pd                    # For data manipulation and DataFrame creation
import numpy as np                     # For numerical operations and arrays
from sklearn.datasets import load_breast_cancer  # To load the breast cancer dataset
from sklearn.model_selection import train_test_split  # To split data into train/test sets
from sklearn.tree import DecisionTreeClassifier  # The decision tree algorithm
from sklearn.tree import plot_tree      # To visualize the decision tree
from sklearn.metrics import accuracy_score, classification_report, confusion_matrix  # Evaluation metrics
import matplotlib.pyplot as plt         # For creating plots and visualizations
import seaborn as sns                   # For enhanced visualizations (nicer looking plots)
import warnings
warnings.filterwarnings('ignore')        # Suppress warning messages


# Load the breast cancer dataset
cancer = load_breast_cancer()           # Loads the Wisconsin Breast Cancer dataset

# Create a DataFrame for better visualization
df = pd.DataFrame(data=cancer.data, columns=cancer.feature_names)  # Convert features to DataFrame
df['target'] = cancer.target             # Add target column (0 or 1)
df['target_name'] = df['target'].map({0: 'malignant', 1: 'benign'})  # Add readable class names

# Display basic information
print("="*60)                            # Print separator line
print("BREAST CANCER DATASET OVERVIEW")
print("="*60)
print("Dataset Shape:", df.shape)        # Shows (569, 32) - 569 samples, 32 columns
print("\nFeatures (30 total):")          # There are 30 medical measurements
print("-" * 30)
for i, feature in enumerate(cancer.feature_names[:10]):  # Show first 10 features
    print(f"{i+1:2d}. {feature}")
print("   ... and 20 more features")

print(f"\nTarget Classes: {cancer.target_names[0]} (0) and {cancer.target_names[1]} (1)")
print("\nClass Distribution:")
print(df['target_name'].value_counts())   # Count of malignant (0) and benign (1)
print(f"\nPercentage Malignant: {(df['target']==0).mean()*100:.1f}%")
print(f"Percentage Benign: {(df['target']==1).mean()*100:.1f}%")

print("\nFirst 5 rows of the dataset:")
print(df.head())                          # Display first 5 rows to see data structure


from sklearn.model_selection import train_test_split
from sklearn.tree import DecisionTreeClassifier
# Assuming you have your features (X) and target (y) ready
# If not, you'll need to load them (e.g., X = df.drop('target', axis=1))

# 1. DEFINE x_train and y_train (This is the missing piece!)
x_train, x_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# 2. Create the Decision Tree model
dt_model = DecisionTreeClassifier(
    max_depth=4,
    min_samples_split=5,
    min_samples_leaf=2,
    max_features='sqrt',
    random_state=42,
    class_weight='balanced'
)

# 3. Train the model
dt_model.fit(x_train, y_train) 

print("Model trained successfully!")
